{% extends 'base.html' %}

{% block body %}
<div class="container px-4 px-lg-5 mt-navbar">
    <div class="row gx-4 gx-lg-5 align-items-center my-5">
        <div class="col-lg-7">
            <img class="img-fluid rounded mb-4 mb-lg-0 img-menor shadow" src="{{ url_for('static', filename='imagens/fundo.jpg') }}" alt="Imagem de fundo viagem" />
        </div>
        <div class="col-lg-5">
            <h1 class="font-weight-light">Bem-Vindo(a), {{ current_user.nome }}</h1>
            <p>Cada viagem √© uma chance de respirar novos ares, viver novos momentos e criar mem√≥rias que ficam para sempre. Explore seus destinos, acompanhe seus planos e continue escrevendo sua pr√≥pria jornada pelo mundo.</p>
            <div class="py-3">
                <a href="{{ url_for('criar_viagem') }}" class="btn btn-dark btn-lg w-100">Iniciar uma nova aventura üåç</a>
            </div>
        </div>
    </div>

    <div class="card text-white bg-secondary my-5 py-4 text-center shadow-sm">
        <div class="card-body">
            <p class="text-white m-0"><strong>Viajar √© colecionar momentos, n√£o coisas. Pronta para a pr√≥xima aventura? ‚úàÔ∏è</strong></p>
        </div>
    </div>

    {% if viagens_com_percentual %}
    <div class="row gx-4 gx-lg-5">
        {% for item in viagens_com_percentual %}
        <div class="col-md-4 mb-5">
            <a href="{{ url_for('viagem_detalhe', id_viagem=item.doc_id) }}" class="text-decoration-none text-dark">
                <div class="card h-100 shadow-sm card-hover">
                    <div class="card-body">
                        <h2 class="card-title h4">{{ item.destino }}</h2>
                        <h6 class="card-subtitle mb-2 text-muted small text-uppercase">Or√ßamento: R$ {{ "%.2f"|format(item.valor_total) }}</h6>
                        <h6 class="card-subtitle mb-3 text-success">Restante: R$ {{ "%.2f"|format(item.valor_restante) }}</h6>
                        
                        <p class="mb-1 small">Percentual gasto:</p>
                        {% if item.percentual_gasto > 0 %}
                            <div class="progress" style="height: 25px; border-radius: 15px;">
                                <div class="progress-bar {{ item.cor }} progress-bar-striped progress-bar-animated" 
                                     role="progressbar" 
                                     style="width: {{ item.percentual_gasto if item.percentual_gasto <= 100 else 100 }}%;"  
                                     aria-valuenow="{{ item.percentual_gasto }}"
                                     aria-valuemin="0" aria-valuemax="100">
                                     {{ "%.1f"|format(item.percentual_gasto) }}%
                                </div>
                            </div>
                        {% else %}
                            <div class="progress" style="height: 25px; border-radius: 15px;">
                                <div class="progress-bar bg-light text-dark border" role="progressbar" style="width: 100%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                            </div>
                        {% endif %}
                    </div>
                    <div class="card-footer bg-transparent border-top-0 pb-3 text-center">
                        <span class="btn btn-sm btn-outline-primary">Ver detalhes</span>
                    </div>
                </div>
            </a>
        </div>
        {% endfor %} 
    </div>
    {% else %}
        <div class="alert alert-info text-center py-5">
            <h4>Voc√™ ainda n√£o tem viagens cadastradas.</h4>
            <p>Que tal come√ßar a planejar seu pr√≥ximo destino agora?</p>
            <a href="{{ url_for('criar_viagem') }}" class="btn btn-primary mt-3">Criar minha primeira viagem</a>
        </div>
    {% endif %}

    <br> 
</div>
{% endblock %}